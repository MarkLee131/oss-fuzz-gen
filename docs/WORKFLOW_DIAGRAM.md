# LogicFuzz Workflow Diagrams

This document contains visual diagrams of the LogicFuzz workflow architecture.

---

## High-Level Architecture

```mermaid
graph TD
    %% Styles
    classDef input fill:#e1f5fe,stroke:#01579b,stroke-width:2px;
    classDef core fill:#fff9c4,stroke:#fbc02d,stroke-width:2px;
    classDef memory fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px,stroke-dasharray: 5 5;

    subgraph Inputs
        Config[User Config]:::input
        FI[Analysis Data]:::input
    end

    Config --> Context[FuzzingContext<br/>Single Source of Truth]:::input
    FI --> Context

    subgraph LogicFuzz_Engine [LogicFuzz Engine]
        Supervisor{Supervisor}:::core
        
        Context --> Supervisor

        Compilation[Phase 1: Compilation<br/>Analyze, Generate, Fix]:::core
        Optimization[Phase 2: Optimization<br/>Execute, Validate Crashes]:::core

        Supervisor <-->|Manage Cycle| Compilation
        Supervisor <-->|Manage Cycle| Optimization
    end

    Memory[(Session Memory)]:::memory -.->|Shared Knowledge| Compilation
    Memory -.->|Shared Knowledge| Optimization

    Supervisor --> Output[Fuzz Targets & Reports]:::input
```

---

## Phase 1: Compilation Phase (Detailed)

```
START
  â”‚
  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PHASE 1: COMPILATION                        â”‚
â”‚              Goal: Compile fuzz target successfully            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚
  â–¼
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ Function Analyzer  â”ƒ  â—€â”€â”€â”€ FuzzingContext
â”ƒ   (LLM Agent)      â”ƒ       - Function signature
â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›       - Call graph
  â”‚                           - Type information
  â”‚ Outputs:
  â”‚ â€¢ API constraints: ["Must call init() before decode()"]
  â”‚ â€¢ Archetype: "stateful_decoder"
  â”‚ â€¢ Calling conventions
  â”‚
  â–¼
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ    Prototyper      â”ƒ  â—€â”€â”€â”€ Session Memory
â”ƒ   (LLM Agent)      â”ƒ       - API constraints
â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›       - Archetype
  â”‚
  â”‚ Generates:
  â”‚ â€¢ fuzz_driver.cc
  â”‚ â€¢ build.sh
  â”‚
  â–¼
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ    Build Node      â”ƒ  â—€â”€â”€â”€ OSS-Fuzz Docker
â”ƒ  (Non-LLM Exec)    â”ƒ       environment
â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›
  â”‚
  â”‚ Performs:
  â”‚ â€¢ Compile with AddressSanitizer
  â”‚ â€¢ Parse compilation errors
  â”‚ â€¢ Validate target function call
  â”‚
  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Compile Success?    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚         â”‚
  â”‚ NO      â”‚ YES
  â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                    â–¼
  â–¼                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“         â”‚ Target Function      â”‚
â”ƒ     Enhancer       â”ƒ         â”‚ Called in Driver?    â”‚
â”ƒ   (LLM Agent)      â”ƒ         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›           â”‚              â”‚
  â”‚                             â”‚ NO           â”‚ YES
  â”‚ Receives:                   â–¼              â–¼
  â”‚ â€¢ Error context (Â±10 lines)â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
  â”‚ â€¢ Session memory (known fixes)â”ƒ    Enhancer       â”ƒ
  â”‚                             â”ƒ  (Validation Fix) â”ƒ
  â”‚ Generates:                  â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›
  â”‚ â€¢ Fixed fuzz_driver.cc        â”‚
  â”‚ â€¢ Updated build.sh            â”‚ Max 2 retries
  â”‚                               â–¼
  â–¼                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚ Still NO?    â”‚
â”‚ Retry Count < 3?     â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚        â”‚
  â”‚           â”‚                 â”‚ YES    â”‚ NO
  â”‚ YES       â”‚ NO              â”‚        â”‚
  â”‚           â”‚                 â–¼        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤              â”Œâ”€â”€â”€â”€â”€â”€â”    â”‚
    Loop back â”‚              â”‚ END  â”‚    â”‚
    to Build  â–¼              â”‚(fail)â”‚    â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”           â””â”€â”€â”€â”€â”€â”€â”˜    â”‚
          â”‚ END  â”‚                       â”‚
          â”‚(fail)â”‚                       â”‚
          â””â”€â”€â”€â”€â”€â”€â”˜                       â”‚
                                         â”‚
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚  Switch to Phase 2     â”‚
                   â”‚  (OPTIMIZATION)        â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Key Points:**
- **Max 3 compilation retries** â†’ Fast failure
- **Max 2 validation retries** â†’ Ensure target function is called
- **Error context extraction** â†’ Only Â±10 lines sent to LLM (95% token savings)
- **Session memory** â†’ Known fixes reused across retries

---

## Phase 2: Optimization Phase (Detailed)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  PHASE 2: OPTIMIZATION                         â”‚
â”‚         Goal: Execute fuzzer and validate crashes              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚
  â–¼
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ  Execution Node    â”ƒ  â—€â”€â”€â”€ Compiled fuzz target
â”ƒ  (Non-LLM Exec)    â”ƒ       - Run timeout: 60-300s
â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›       - LLVM coverage enabled
  â”‚
  â”‚ Collects:
  â”‚ â€¢ LLVM source-based coverage (textcov)
  â”‚ â€¢ ASAN/UBSAN crash reports
  â”‚ â€¢ Crash reproducers
  â”‚
  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Crash Detected?    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚           â”‚
  â”‚ NO        â”‚ YES
  â”‚           â”‚
  â–¼           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”‚  Log Coverage    â”‚  â”ƒ  Crash Analyzer    â”ƒ
â”‚  - PC coverage   â”‚  â”ƒ   (LLM Agent)      â”ƒ
â”‚  - Line coverage â”‚  â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›
â”‚  - Total PCs     â”‚    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ Analyzes:
  â”‚                     â”‚ â€¢ Stack trace
  â”‚                     â”‚ â€¢ ASAN report
  â–¼                     â”‚ â€¢ Crash location
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚   END    â”‚            â”‚ Classifies:
â”‚    âœ“     â”‚            â”‚ â€¢ heap-buffer-overflow
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚ â€¢ stack-buffer-overflow
                        â”‚ â€¢ use-after-free
                        â”‚ â€¢ timeout
                        â”‚ â€¢ out-of-memory
                        â”‚
                        â–¼
              â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
              â”ƒ Crash Feasibility      â”ƒ
              â”ƒ      Analyzer          â”ƒ
              â”ƒ    (LLM Agent)         â”ƒ
              â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›
                â”‚
                â”‚ Validates:
                â”‚ â€¢ Is crash in target code? (not harness)
                â”‚ â€¢ Reachable in real-world usage?
                â”‚ â€¢ Security-relevant?
                â”‚ â€¢ Reproducible?
                â”‚
                â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚   Feasible?     â”‚
         â”‚ (True Bug?)     â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚             â”‚
           â”‚ YES         â”‚ NO
           â”‚             â”‚
           â–¼             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
    â”‚    END     â”‚  â”ƒ     Enhancer       â”ƒ
    â”‚    ğŸ‰      â”‚  â”ƒ  (False Positive   â”ƒ
    â”‚ (True Bug!)â”‚  â”ƒ      Fix)          â”ƒ
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›
                      â”‚
                      â”‚ Fixes:
                      â”‚ â€¢ Timeout in harness
                      â”‚ â€¢ Initialization issue
                      â”‚ â€¢ Cleanup issue
                      â”‚
                      â”‚ (1 attempt only)
                      â”‚
                      â–¼
                   â”Œâ”€â”€â”€â”€â”€â”€â”
                   â”‚ END  â”‚
                   â”‚  âœ“   â”‚
                   â””â”€â”€â”€â”€â”€â”€â”˜
```

**Key Points:**
- **Single-pass execution** â†’ No iteration loops
- **No coverage iteration** â†’ Log coverage and move on
- **Two-stage crash validation** â†’ Filter false positives
- **One fix attempt** for false positives â†’ Fast termination

---

## Agent Interaction Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 Supervisor + Session Memory                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Session Memory (Shared Knowledge Base)                   â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚  â”‚ â€¢ API Constraints: ["init() before decode()"]        â”‚ â”‚  â”‚
â”‚  â”‚  â”‚ â€¢ Archetype: "stateful_decoder"                      â”‚ â”‚  â”‚
â”‚  â”‚  â”‚ â€¢ Known Fixes: ["undefined ref â†’ Add -lz"]          â”‚ â”‚  â”‚
â”‚  â”‚  â”‚ â€¢ Build Context: Error location + Â±10 lines         â”‚ â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â”‚                                                           â”‚  â”‚
â”‚  â”‚  Injection: Top-3 relevant items by confidence + recency â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚             Agent Ecosystem                              â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    
    ğŸ”µ Control Layer
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚    Supervisor       â”‚  â€¢ Phase-aware routing
    â”‚  (Router/Non-LLM)   â”‚  â€¢ Retry limit enforcement
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â€¢ Loop prevention
             â”‚
             â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
             â”‚                                          â”‚
             â–¼                                          â–¼
    ğŸŸ¡ Generation Layer                      ğŸ”´ Analysis Layer
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Function Analyzer   â”‚                 â”‚  Crash Analyzer     â”‚
    â”‚    (LLM Agent)      â”‚                 â”‚   (LLM Agent)       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚                                          â”‚
             â–¼                                          â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚    Prototyper       â”‚                 â”‚Crash Feasibility    â”‚
    â”‚    (LLM Agent)      â”‚                 â”‚    Analyzer         â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚   (LLM Agent)       â”‚
             â”‚                               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚     Enhancer        â”‚
    â”‚    (LLM Agent)      â”‚
    â”‚  â€¢ Compilation fix  â”‚
    â”‚  â€¢ Validation fix   â”‚
    â”‚  â€¢ False pos. fix   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
    ğŸŸ£ Execution Layer
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚    Build Node       â”‚                 â”‚  Execution Node     â”‚
    â”‚  (Non-LLM Exec)     â”‚                 â”‚  (Non-LLM Exec)     â”‚
    â”‚  â€¢ OSS-Fuzz build   â”‚                 â”‚  â€¢ Run fuzzer       â”‚
    â”‚  â€¢ Error parsing    â”‚                 â”‚  â€¢ Collect coverage â”‚
    â”‚  â€¢ Validation       â”‚                 â”‚  â€¢ Detect crashes   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## State Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             FuzzingWorkflowState (TypedDict)             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Initial State                     Updated by Nodes
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â€¢ benchmark     â”‚              â”‚ Function Analyzer:     â”‚
â”‚ â€¢ trial         â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ â€¢ function_analysis   â”‚
â”‚ â€¢ work_dirs     â”‚              â”‚ â€¢ session_memory       â”‚
â”‚ â€¢ context       â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
                                           â–¼
                                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                 â”‚ Prototyper:            â”‚
                                 â”‚ â€¢ fuzz_target_source   â”‚
                                 â”‚ â€¢ build_script_source  â”‚
                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                           â”‚
                                           â–¼
                                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                 â”‚ Build Node:            â”‚
                                 â”‚ â€¢ compile_success      â”‚
                                 â”‚ â€¢ build_errors         â”‚
                                 â”‚ â€¢ target_function_     â”‚
                                 â”‚   called               â”‚
                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                           â”‚
                                           â–¼
                                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                 â”‚ Enhancer:              â”‚
                                 â”‚ â€¢ fuzz_target_source   â”‚
                                 â”‚   (fixed)              â”‚
                                 â”‚ â€¢ session_memory       â”‚
                                 â”‚   (new fixes)          â”‚
                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                           â”‚
                                           â–¼
                                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                 â”‚ Execution Node:        â”‚
                                 â”‚ â€¢ run_success          â”‚
                                 â”‚ â€¢ crashes              â”‚
                                 â”‚ â€¢ coverage_percent     â”‚
                                 â”‚ â€¢ crash_info           â”‚
                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                           â”‚
                                           â–¼
                                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                 â”‚ Crash Analyzer:        â”‚
                                 â”‚ â€¢ crash_analysis       â”‚
                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                           â”‚
                                           â–¼
                                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                 â”‚ Crash Feasibility:     â”‚
                                 â”‚ â€¢ context_analysis     â”‚
                                 â”‚   - feasible: bool     â”‚
                                 â”‚   - reasoning          â”‚
                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Final State
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â€¢ All agent outputs                                     â”‚
â”‚ â€¢ Coverage metrics                                      â”‚
â”‚ â€¢ Crash analysis (if applicable)                        â”‚
â”‚ â€¢ Session memory (accumulated knowledge)                â”‚
â”‚ â€¢ workflow_phase: "optimization"                        â”‚
â”‚ â€¢ node_visit_counts: {...}                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Decision Tree: Supervisor Routing Logic

```
                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚   START          â”‚
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ function_analysis      â”‚
                    â”‚ exists?                â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚                   â”‚
                      â”‚ NO                â”‚ YES
                      â–¼                   â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚function_analyzerâ”‚  â”‚fuzz_target_     â”‚
              â”‚                 â”‚  â”‚source exists?   â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚           â”‚
                                     â”‚ NO        â”‚ YES
                                     â–¼           â–¼
                             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                             â”‚ prototyper  â”‚  â”‚ workflow_phase? â”‚
                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                â”‚            â”‚
                                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤            â”‚
                                   â”‚compilation â”‚optimizationâ”‚
                                   â–¼            â–¼            â–¼
                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚ compile_success?â”‚         â”‚  run_success?   â”‚
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚          â”‚                â”‚          â”‚
                           â”‚ None     â”‚ True/False     â”‚ None     â”‚ True/False
                           â–¼          â–¼                â–¼          â–¼
                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                      â”‚ build  â”‚  â”‚ False?  â”‚    â”‚execute â”‚  â”‚crashes? â”‚
                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚      â”‚                    â”‚      â”‚
                                   â”‚ YES  â”‚ NO                 â”‚ YES  â”‚ NO
                                   â–¼      â”‚                    â–¼      â–¼
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”
                        â”‚retry_count < 3?â”‚â”‚         â”‚crash_analyzerâ”‚ â”‚END â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜
                          â”‚          â”‚    â”‚                â”‚
                          â”‚ YES      â”‚ NO â”‚                â–¼
                          â–¼          â–¼    â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”  â”‚     â”‚crash_feasibility_  â”‚
                     â”‚enhancerâ”‚  â”‚END â”‚  â”‚     â”‚analyzer            â”‚
                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”˜  â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                         â”‚                â”‚
                                         â”‚                â–¼
                                         â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                         â”‚      â”‚ feasible?        â”‚
                                         â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                         â”‚        â”‚            â”‚
                                         â”‚        â”‚ YES        â”‚ NO
                                         â”‚        â–¼            â–¼
                                         â”‚     â”Œâ”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
                                         â”‚     â”‚END â”‚    â”‚enhancerâ”‚
                                         â”‚     â”‚ğŸ‰  â”‚    â”‚(1 fix) â”‚
                                         â”‚     â””â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                         â”‚                   â”‚
                                         â”‚                   â–¼
                                         â”‚                â”Œâ”€â”€â”€â”€â”
                                         â”‚                â”‚END â”‚
                                         â”‚                â””â”€â”€â”€â”€â”˜
                                         â”‚
                                         â”‚ (validation check)
                                         â”‚
                                         â–¼
                                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                â”‚target_function_ â”‚
                                â”‚called?          â”‚
                                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚            â”‚
                                  â”‚ YES        â”‚ NO
                                  â–¼            â–¼
                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                           â”‚execution â”‚  â”‚validation_fail_â”‚
                           â”‚(Phase 2) â”‚  â”‚count < 2?      â”‚
                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                           â”‚          â”‚
                                           â”‚ YES      â”‚ NO
                                           â–¼          â–¼
                                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”
                                      â”‚enhancerâ”‚  â”‚END â”‚
                                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”˜
```

---

## Token Flow Analysis

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Token Usage Per Phase                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Phase 1: COMPILATION
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Node                 â”‚ Tokens   â”‚ Description            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Function Analyzer    â”‚ 5-10k    â”‚ Initial analysis       â”‚
â”‚ Prototyper           â”‚ 8-15k    â”‚ Code generation        â”‚
â”‚ Enhancer (per retry) â”‚ 3-5k     â”‚ Error fixing           â”‚
â”‚   Ã— 2-3 retries      â”‚ 6-15k    â”‚ Typical: 2 retries     â”‚
â”‚ Session Memory       â”‚ 0.5-1k   â”‚ Injected into prompts  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ TOTAL (Phase 1)      â”‚ 20-40k   â”‚ Success case           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Phase 2: OPTIMIZATION
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Node                 â”‚ Tokens   â”‚ Description            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Crash Analyzer       â”‚ 2-4k     â”‚ If crash detected      â”‚
â”‚ Crash Feasibility    â”‚ 3-6k     â”‚ Deep validation        â”‚
â”‚ Enhancer (false pos) â”‚ 3-5k     â”‚ 1 fix attempt          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ TOTAL (Phase 2)      â”‚ 0-15k    â”‚ 0 if no crash          â”‚
â”‚                      â”‚          â”‚ 5-10k if feasible crashâ”‚
â”‚                      â”‚          â”‚ 8-15k if false positiveâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

GRAND TOTAL: 20-55k tokens per trial

Comparison with Previous Version (with conversation history):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Component            â”‚ Old      â”‚ New      â”‚ Savings    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Conversation History â”‚ 100k+    â”‚ 0        â”‚ 100%       â”‚
â”‚ Session Memory       â”‚ 0        â”‚ 0.5-1k   â”‚ N/A        â”‚
â”‚ Error Context        â”‚ Full fileâ”‚ Â±10 linesâ”‚ 95%        â”‚
â”‚ Coverage Iteration   â”‚ 30-50k   â”‚ 0        â”‚ 100%       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ TOTAL SAVINGS        â”‚          â”‚          â”‚ ~70-80%    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Error Handling Strategies

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Error Types and Recovery Strategies           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Compilation Errors
â”œâ”€ Syntax errors           â†’ Enhancer (Â±10 lines context)
â”œâ”€ Undefined references    â†’ Enhancer + session memory (known fixes)
â”œâ”€ Type mismatches         â†’ Enhancer (error context)
â”œâ”€ Missing headers         â†’ Enhancer (check FuzzingContext.header_info)
â””â”€ Linker errors           â†’ Enhancer (update build.sh)
   â”‚
   â””â”€ Max 3 retries â†’ END (fail fast)

Validation Errors
â”œâ”€ Target function not called  â†’ Enhancer (fix driver logic)
â””â”€ Incorrect function signature â†’ Enhancer (fix function call)
   â”‚
   â””â”€ Max 2 retries â†’ END (fail fast)

Runtime Errors (Optimization Phase)
â”œâ”€ Crashes (in target code)
â”‚  â”œâ”€ heap-buffer-overflow   â†’ Crash Analyzer â†’ Feasibility â†’ END (ğŸ‰ bug!)
â”‚  â”œâ”€ use-after-free         â†’ Crash Analyzer â†’ Feasibility â†’ END (ğŸ‰ bug!)
â”‚  â””â”€ stack-buffer-overflow  â†’ Crash Analyzer â†’ Feasibility â†’ END (ğŸ‰ bug!)
â”‚
â”œâ”€ Crashes (in harness)
â”‚  â”œâ”€ Timeout                â†’ Feasibility (not feasible) â†’ Enhancer (1 fix)
â”‚  â”œâ”€ Initialization error   â†’ Feasibility (not feasible) â†’ Enhancer (1 fix)
â”‚  â””â”€ Cleanup error          â†’ Feasibility (not feasible) â†’ Enhancer (1 fix)
â”‚
â””â”€ Execution failures
   â”œâ”€ Timeout (pure)         â†’ END (no fix attempt)
   â””â”€ Other infra errors     â†’ Enhancer (1 fix) â†’ END
```

---

## Key Design Decisions

### 1. Why No Coverage Iteration?

**Old approach:**
```
Execute â†’ Coverage Analyzer â†’ Enhancer â†’ Build â†’ Execute â†’ ...
(Repeat until coverage stable)

Cost: ~50k tokens + 5 min per iteration
Benefit: ~5-10% coverage increase
ROI: Low (high cost, marginal bug finding)
```

**New approach:**
```
Execute once â†’ Log coverage â†’ END

Cost: 0 tokens (no iteration)
Benefit: Same bug finding rate
ROI: High (fast termination, low cost)
```

### 2. Why Session Memory Over Conversation History?

**Conversation history:**
- Full message logs per agent: 100k+ tokens
- Redundant information (repeated prompts, full code)
- Slow to process

**Session memory:**
- Key insights only: 3-5 items (~1k tokens)
- Structured data (constraints, fixes, archetypes)
- Fast to inject

**Result:** 90% memory reduction, faster execution

### 3. Why Strict Retry Limits?

**Empirical observation:**
- If 3 compilation retries don't fix it â†’ likely unfixable (missing library, unsupported API)
- If 2 validation retries don't fix it â†’ likely architectural issue (wrong approach)
- If 1 false positive fix doesn't work â†’ likely complex harness issue (not worth iteration)

**Result:** Faster failure, clearer error messages, lower token cost

---

## Next Steps

For more details on specific components:

- **Implementation**: See [agent_graph/README.md](../agent_graph/README.md)
- **Prompts**: See [prompts/](../prompts/)
- **Setup Guide**: See [docs/NEW_PROJECT_SETUP.md](NEW_PROJECT_SETUP.md)
- **Quick Start**: See [Usage.md](../Usage.md)

