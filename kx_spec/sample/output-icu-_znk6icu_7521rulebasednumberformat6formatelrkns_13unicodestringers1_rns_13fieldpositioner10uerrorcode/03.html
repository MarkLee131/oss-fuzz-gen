<!doctype html>

<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Experiment results</title>
<style>
* {
    box-sizing: border-box;
}

html {
    line-height: 1.15;
}

body {
    font-family: sans-serif;
    font-size: 16px;
}

table {
    border-collapse: collapse;
    border-spacing: 0;
}

td, th {
    border-right: 1px #dedede solid;
    border-bottom: 1px #dedede solid;
    padding: 5px;
    text-align: left;
}
td:first-child, th:first-child {
    border-left: 1px #dedede solid;
}
th {
    border-top: 1px #dedede solid;
}

tbody tr:nth-child(odd) {
    background-color: #f4f5ff;
}
</style>
<body>
    LLM: 
    
<h1>output-icu-_znk6icu_7521rulebasednumberformat6formatelrkns_13unicodestringers1_rns_13fieldpositioner10uerrorcode / 03</h1>
Bug: False
<br>
Crash reason: NO_SEMANTIC_ERR
<br>
<br>




<h3>Final code</h3>

<pre>
#include &lt;fuzzer/FuzzedDataProvider.h&gt;
#include &lt;unicode/unistr.h&gt;
#include &lt;unicode/rbnf.h&gt;
#include &lt;unicode/fieldpos.h&gt;
#include &lt;unicode/utypes.h&gt;
#include &lt;unicode/locid.h&gt;
#include &lt;unicode/parseerr.h&gt;

extern &#34;C&#34; int LLVMFuzzerInitialize(int *argc, char ***argv) {
    return 0;
}

extern &#34;C&#34; int LLVMFuzzerTestOneInput(const uint8_t *data, size_t size) {
    if (size &lt; sizeof(int64_t) + 1) {
        return 0;
    }
    
    FuzzedDataProvider provider(data, size);

    int64_t number = provider.ConsumeIntegral&lt;int64_t&gt;();

    std::string ruleSetString = provider.ConsumeRandomLengthString();
    icu::UnicodeString ruleSet(ruleSetString.c_str(), ruleSetString.length(), &#34;UTF-8&#34;);

    UErrorCode status = U_ZERO_ERROR;
    UParseError perror;
    icu::RuleBasedNumberFormat rbnf(ruleSet, perror, status);
    if (U_FAILURE(status)) {
        return 0;
    }

    icu::UnicodeString output;
    icu::FieldPosition pos;

    rbnf.format(number, ruleSet, output, pos, status);

    if (U_FAILURE(status)) {
    }

    return 0;
}
</pre>


<h3>Fixer prompt #1</h3>
<pre>

Given the following C++ fuzz harness and its build error message, fix the code to make it build for fuzzing.

If there is undeclared identifier or unknown type name error, fix it by finding and including the related libraries.

You MUST wrap the headers with &lt;code&gt;extern &#34;C&#34;&lt;/code&gt; if they are C headers, especially the headers are from the project.

Note that some code may need to be wrapped with &lt;code&gt;extern &#34;C&#34;&lt;/code&gt; as their source is C program.

MUST RETURN THE FULL CODE, INCLUDING UNCHANGED PARTS.
EXTREMELY IMPORTANT: AVOID USING &lt;code&gt;goto&lt;/code&gt;. If you have to write code using &lt;code&gt;goto&lt;/code&gt;, you MUST MUST also declare all variables BEFORE the &lt;code&gt;goto&lt;/code&gt;. Never introduce new variables after the &lt;code&gt;goto&lt;/code&gt;.

Below is the code needs to be built:
&lt;code&gt;
#include &lt;fuzzer/FuzzedDataProvider.h&gt;
#include &lt;unicode/unistr.h&gt;
#include &lt;unicode/rbnf.h&gt;
#include &lt;unicode/fieldpos.h&gt;
#include &lt;unicode/utypes.h&gt;

extern &#34;C&#34; int LLVMFuzzerInitialize(int *argc, char ***argv) {
    return 0;
}

extern &#34;C&#34; int LLVMFuzzerTestOneInput(const uint8_t *data, size_t size) {
    if (size &lt; sizeof(int64_t) + 1) {
        return 0;
    }
    
    FuzzedDataProvider provider(data, size);

    int64_t number = provider.ConsumeIntegral&lt;int64_t&gt;();

    std::string ruleSetString = provider.ConsumeRandomLengthString();
    UnicodeString ruleSet(ruleSetString.c_str(), ruleSetString.length(), &#34;UTF-8&#34;);

    UErrorCode status = U_ZERO_ERROR;
    icu::RuleBasedNumberFormat rbnf(ruleSet, status);
    if (U_FAILURE(status)) {
        return 0;
    }

    UnicodeString output;
    FieldPosition pos;

    rbnf.format(number, ruleSet, output, pos, status);

    if (U_FAILURE(status)) {
    }

    return 0;
}
&lt;/code&gt;

The code has the following build issues:
&lt;error&gt;
/src/icu/icu4c/source/test/fuzzer/relative_date_time_formatter_fuzzer.cpp:21:5: error: unknown type name &#39;UnicodeString&#39;; did you mean &#39;icu_76::UnicodeString&#39;?
   21 |     UnicodeString ruleSet(ruleSetString.c_str(), ruleSetString.length(), &#34;UTF-8&#34;);
      |     ^~~~~~~~~~~~~
      |     icu_76::UnicodeString
/src/icu/icu4c/source/common/unicode/locid.h:57:7: note: &#39;icu_76::UnicodeString&#39; declared here
   57 | class UnicodeString;
      |       ^
/src/icu/icu4c/source/test/fuzzer/relative_date_time_formatter_fuzzer.cpp:24:32: error: no matching constructor for initialization of &#39;icu::RuleBasedNumberFormat&#39;
   24 |     icu::RuleBasedNumberFormat rbnf(ruleSet, status);
      |                                ^    ~~~~~~~~~~~~~~~
/src/icu/icu4c/source/i18n/unicode/rbnf.h:712:3: note: candidate constructor not viable: requires single argument &#39;rhs&#39;, but 2 arguments were provided
  712 |   RuleBasedNumberFormat(const RuleBasedNumberFormat&amp; rhs);
      |   ^                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
/src/icu/icu4c/source/i18n/unicode/rbnf.h:608:5: note: candidate constructor not viable: requires 3 arguments, but 2 were provided
  608 |     RuleBasedNumberFormat(const UnicodeString&amp; rules, UParseError&amp; perror, UErrorCode&amp; status);
      |     ^                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
/src/icu/icu4c/source/i18n/unicode/rbnf.h:701:3: note: candidate constructor not viable: requires 3 arguments, but 2 were provided
  701 |   RuleBasedNumberFormat(URBNFRuleSetTag tag, const Locale&amp; locale, UErrorCode&amp; status);
      |   ^                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
/src/icu/icu4c/source/i18n/unicode/rbnf.h:1075:5: note: candidate constructor not viable: requires 0 arguments, but 2 were provided
 1075 |     RuleBasedNumberFormat() = delete; // default constructor not implemented
      |     ^
/src/icu/icu4c/source/i18n/unicode/rbnf.h:633:5: note: candidate constructor not viable: requires 4 arguments, but 2 were provided
  633 |     RuleBasedNumberFormat(const UnicodeString&amp; rules, const UnicodeString&amp; localizations,
      |     ^                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  634 |                         UParseError&amp; perror, UErrorCode&amp; status);
      |                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
/src/icu/icu4c/source/i18n/unicode/rbnf.h:651:3: note: candidate constructor not viable: requires 4 arguments, but 2 were provided
  651 |   RuleBasedNumberFormat(const UnicodeString&amp; rules, const Locale&amp; locale,
      |   ^                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  652 |                         UParseError&amp; perror, UErrorCode&amp; status);
      |                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
/src/icu/icu4c/source/i18n/unicode/rbnf.h:680:5: note: candidate constructor not viable: requires 5 arguments, but 2 were provided
  680 |     RuleBasedNumberFormat(const UnicodeString&amp; rules, const UnicodeString&amp; localizations,
      |     ^                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  681 |                         const Locale&amp; locale, UParseError&amp; perror, UErrorCode&amp; status);
      |                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
/src/icu/icu4c/source/i18n/unicode/rbnf.h:1079:5: note: candidate constructor not viable: requires 5 arguments, but 2 were provided
 1079 |     RuleBasedNumberFormat(const UnicodeString&amp; description, LocalizationInfo* localizations,
      |     ^                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 1080 |               const Locale&amp; locale, UParseError&amp; perror, UErrorCode&amp; status);
      |               ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
/src/icu/icu4c/source/test/fuzzer/relative_date_time_formatter_fuzzer.cpp:29:5: error: unknown type name &#39;UnicodeString&#39;; did you mean &#39;icu_76::UnicodeString&#39;?
   29 |     UnicodeString output;
      |     ^~~~~~~~~~~~~
      |     icu_76::UnicodeString
/src/icu/icu4c/source/common/unicode/locid.h:57:7: note: &#39;icu_76::UnicodeString&#39; declared here
   57 | class UnicodeString;
      |       ^
/src/icu/icu4c/source/test/fuzzer/relative_date_time_formatter_fuzzer.cpp:30:5: error: unknown type name &#39;FieldPosition&#39;; did you mean &#39;UFieldPosition&#39;?
   30 |     FieldPosition pos;
      |     ^~~~~~~~~~~~~
      |     UFieldPosition
/src/icu/icu4c/source/common/unicode/umisc.h:50:3: note: &#39;UFieldPosition&#39; declared here
   50 | } UFieldPosition;
      |   ^
/src/icu/icu4c/source/test/fuzzer/relative_date_time_formatter_fuzzer.cpp:32:10: error: no matching member function for call to &#39;format&#39;
   32 |     rbnf.format(number, ruleSet, output, pos, status);
      |     ~~~~~^~~~~~
/src/icu/icu4c/source/i18n/unicode/rbnf.h:880:26: note: candidate function not viable: no known conversion from &#39;UFieldPosition&#39; to &#39;FieldPosition &amp;&#39; for 4th argument
  880 |   virtual UnicodeString&amp; format(int64_t number,
      |                          ^
  881 |                                 const UnicodeString&amp; ruleSetName,
  882 |                                 UnicodeString&amp; toAppendTo,
  883 |                                 FieldPosition&amp; pos,
      |                                 ~~~~~~~~~~~~~~~~~~
&lt;/error&gt;

Fix code:
1. Consider possible solutions for the issues listed above.
2. Choose a solution that can maximize fuzzing result, which is utilizing the function under test and feeding it not null input.
3. Apply the solutions to the original code.
It&#39;s important to show the complete code, not only the fixed line.
&lt;solution&gt;
</pre>



<h3>Code #1</h3>

<pre>
Here&#39;s the corrected code:

```cpp
#include &lt;fuzzer/FuzzedDataProvider.h&gt;
#include &lt;unicode/unistr.h&gt;
#include &lt;unicode/rbnf.h&gt;
#include &lt;unicode/fieldpos.h&gt;
#include &lt;unicode/utypes.h&gt;
#include &lt;unicode/locid.h&gt;
#include &lt;unicode/parseerr.h&gt;

extern &#34;C&#34; int LLVMFuzzerInitialize(int *argc, char ***argv) {
    return 0;
}

extern &#34;C&#34; int LLVMFuzzerTestOneInput(const uint8_t *data, size_t size) {
    if (size &lt; sizeof(int64_t) + 1) {
        return 0;
    }
    
    FuzzedDataProvider provider(data, size);

    int64_t number = provider.ConsumeIntegral&lt;int64_t&gt;();

    std::string ruleSetString = provider.ConsumeRandomLengthString();
    icu::UnicodeString ruleSet(ruleSetString.c_str(), ruleSetString.length(), &#34;UTF-8&#34;);

    UErrorCode status = U_ZERO_ERROR;
    UParseError perror;
    icu::RuleBasedNumberFormat rbnf(ruleSet, perror, status);
    if (U_FAILURE(status)) {
        return 0;
    }

    icu::UnicodeString output;
    icu::FieldPosition pos;

    rbnf.format(number, ruleSet, output, pos, status);

    if (U_FAILURE(status)) {
    }

    return 0;
}
```

### Explanation of Fixes:
1. **Namespace Correction**: The error indicates that the type names should be prefixed with the `icu` namespace. Therefore, `UnicodeString`, `RuleBasedNumberFormat`, and `FieldPosition` were changed to `icu::UnicodeString`, `icu::RuleBasedNumberFormat`, and `icu::FieldPosition` respectively.

2. **Constructor Correction**: The error indicates that the constructor for `RuleBasedNumberFormat` requires three arguments (the rule set, a `UParseError` reference, and a `UErrorCode` reference). Thus, a `UParseError perror` variable was added and passed to the constructor.

3. **Header Inclusion**: The error indicates that the `UParseError` type is undeclared. The `&lt;unicode/parseerr.h&gt;` header was included to resolve this.

By making these changes, the code should now compile correctly and be ready for fuzzing.
</pre>


<h2>Logs</h2>
<pre>
Fixing /home/kaixuan/FDG_LLM/oss-fuzz-gen/results/output-icu-_znk6icu_7521rulebasednumberformat6formatelrkns_13unicodestringers1_rns_13fieldpositioner10uerrorcode/fixed_targets/03.cpp with gpt-4o, attempt 1.
Successfully built /home/kaixuan/FDG_LLM/oss-fuzz-gen/results/output-icu-_znk6icu_7521rulebasednumberformat6formatelrkns_13unicodestringers1_rns_13fieldpositioner10uerrorcode/fixed_targets/03.cpp with gpt-4o in 1 iterations of fixing.
Result for icu-znk6icu_7521rulebasednumberformat6formatelrkns_13unicodestringers1_rns_13fieldpositioner10uerrorcode-03: crashes=False, coverage=0.02672209026128266 (2250/84200), coverage diff=0.00029110819314718926 (47/161452)

</pre>

<h2>Run logs</h2>
<pre>
INFO:__main__:Running: docker run --rm --privileged --shm-size=2g --platform linux/amd64 -e FUZZING_ENGINE=libfuzzer -e SANITIZER=address -e RUN_FUZZER_MODE=interactive -e HELPER=True -v /home/kaixuan/FDG_LLM/oss-fuzz-gen/results/output-icu-_znk6icu_7521rulebasednumberformat6formatelrkns_13unicodestringers1_rns_13fieldpositioner10uerrorcode/corpora/03.cpp:/tmp/relative_date_time_formatter_fuzzer_corpus -v /tmp/tmpk31m_hoq/build/out/icu-znk6icu_7521rulebasednumberformat6formatelrkns_13unicodestringers1_rns_13fieldpositioner10uerrorcode-03:/out -t gcr.io/oss-fuzz-base/base-runner run_fuzzer relative_date_time_formatter_fuzzer -print_final_stats=1 -max_total_time=30 -len_control=0 -timeout=30.
vm.mmap_rnd_bits = 28
rm: cannot remove &#39;/tmp/relative_date_time_formatter_fuzzer_corpus&#39;: Device or resource busy
/out/relative_date_time_formatter_fuzzer -rss_limit_mb=2560 -timeout=25 -print_final_stats=1 -max_total_time=30 -len_control=0 -timeout=30 /tmp/relative_date_time_formatter_fuzzer_corpus &lt; /dev/null
INFO: Running with entropic power schedule (0xFF, 100).
INFO: Seed: 3806997653
INFO: Loaded 1 modules   (84200 inline 8-bit counters): 84200 [0x55bc51a4a6f0, 0x55bc51a5efd8), 
INFO: Loaded 1 PC tables (84200 PCs): 84200 [0x55bc51a5efd8,0x55bc51ba7e58), 
INFO:        0 files found in /tmp/relative_date_time_formatter_fuzzer_corpus
INFO: -max_len is not provided; libFuzzer will not generate inputs larger than 4096 bytes
INFO: A corpus is not provided, starting from an empty corpus
#2	INITED cov: 2 ft: 2 corp: 1/1b exec/s: 0 rss: 38Mb
	NEW_FUNC[1/236]: 0x55bc4f47e720 in FuzzedDataProvider::ConsumeRandomLengthString(unsigned long) /usr/local/lib/clang/18/include/fuzzer/FuzzedDataProvider.h:152
	NEW_FUNC[2/236]: 0x55bc4f47f3a0 in icu_76::FieldPosition::~FieldPosition() /src/icu/icu4c/source/i18n/format.cpp:62
#25	NEW    cov: 1591 ft: 1592 corp: 2/111b lim: 4096 exec/s: 25 rss: 43Mb L: 110/110 MS: 2 ShuffleBytes-InsertRepeatedBytes-
#31	NEW    cov: 1592 ft: 1692 corp: 3/221b lim: 4096 exec/s: 31 rss: 43Mb L: 110/110 MS: 1 CopyPart-
#33	NEW    cov: 1592 ft: 1699 corp: 4/370b lim: 4096 exec/s: 33 rss: 43Mb L: 149/149 MS: 2 ChangeBit-InsertRepeatedBytes-
	NEW_FUNC[1/3]: 0x55bc4fa1ecb0 in UCNV_TO_U_CALLBACK_SUBSTITUTE_76 /src/icu/icu4c/source/common/ucnv_err.cpp:389
	NEW_FUNC[2/3]: 0x55bc4faaace0 in ucnv_cbToUWriteSub_76 /src/icu/icu4c/source/common/ucnv_cb.cpp:250
#34	NEW    cov: 1614 ft: 1725 corp: 5/621b lim: 4096 exec/s: 34 rss: 43Mb L: 251/251 MS: 1 InsertRepeatedBytes-
#35	NEW    cov: 1614 ft: 1726 corp: 6/732b lim: 4096 exec/s: 35 rss: 43Mb L: 111/251 MS: 1 InsertByte-
#38	NEW    cov: 1614 ft: 1729 corp: 7/1042b lim: 4096 exec/s: 38 rss: 43Mb L: 310/310 MS: 3 ShuffleBytes-ChangeByte-CrossOver-
#39	NEW    cov: 1614 ft: 1760 corp: 8/1191b lim: 4096 exec/s: 39 rss: 43Mb L: 149/310 MS: 1 ChangeBinInt-
#40	NEW    cov: 1614 ft: 1761 corp: 9/1562b lim: 4096 exec/s: 40 rss: 43Mb L: 371/371 MS: 1 InsertRepeatedBytes-
#41	NEW    cov: 1620 ft: 1767 corp: 10/1711b lim: 4096 exec/s: 41 rss: 43Mb L: 149/371 MS: 1 ChangeBinInt-
#43	NEW    cov: 1620 ft: 1770 corp: 11/1835b lim: 4096 exec/s: 43 rss: 43Mb L: 124/371 MS: 2 EraseBytes-InsertRepeatedBytes-
#47	NEW    cov: 1642 ft: 1895 corp: 12/1844b lim: 4096 exec/s: 47 rss: 43Mb L: 9/371 MS: 4 ShuffleBytes-ShuffleBytes-ShuffleBytes-CMP- DE: &#34;\000\000\000\000\000\000\000\003&#34;-
#49	NEW    cov: 1650 ft: 1918 corp: 13/1993b lim: 4096 exec/s: 49 rss: 43Mb L: 149/371 MS: 2 CrossOver-ChangeByte-
#50	NEW    cov: 1651 ft: 1919 corp: 14/2120b lim: 4096 exec/s: 50 rss: 43Mb L: 127/371 MS: 1 EraseBytes-
#52	NEW    cov: 1651 ft: 1921 corp: 15/2289b lim: 4096 exec/s: 52 rss: 43Mb L: 169/371 MS: 2 CopyPart-CrossOver-
#53	NEW    cov: 1656 ft: 1949 corp: 16/2302b lim: 4096 exec/s: 53 rss: 43Mb L: 13/371 MS: 1 CMP- DE: &#34;\242\000\000\000&#34;-
#60	NEW    cov: 1656 ft: 1950 corp: 17/2458b lim: 4096 exec/s: 60 rss: 44Mb L: 156/371 MS: 2 EraseBytes-CrossOver-
#68	REDUCE cov: 1656 ft: 1950 corp: 17/2437b lim: 4096 exec/s: 68 rss: 44Mb L: 128/371 MS: 3 ChangeBit-ChangeBinInt-EraseBytes-
#69	NEW    cov: 1657 ft: 1960 corp: 18/2537b lim: 4096 exec/s: 69 rss: 44Mb L: 100/371 MS: 1 InsertRepeatedBytes-
#71	NEW    cov: 1657 ft: 1984 corp: 19/2901b lim: 4096 exec/s: 71 rss: 44Mb L: 364/371 MS: 2 ShuffleBytes-CopyPart-
#72	NEW    cov: 1657 ft: 1986 corp: 20/3120b lim: 4096 exec/s: 72 rss: 44Mb L: 219/371 MS: 1 EraseBytes-
#78	NEW    cov: 1657 ft: 2012 corp: 21/3273b lim: 4096 exec/s: 78 rss: 44Mb L: 153/371 MS: 1 CMP- DE: &#34;\377\377\003\000&#34;-
#83	NEW    cov: 1657 ft: 2038 corp: 22/3386b lim: 4096 exec/s: 83 rss: 44Mb L: 113/371 MS: 5 ChangeByte-ChangeBit-EraseBytes-CopyPart-CMP- DE: &#34;\376\377\377\377&#34;-
#98	NEW    cov: 1659 ft: 2052 corp: 23/3562b lim: 4096 exec/s: 98 rss: 44Mb L: 176/371 MS: 5 InsertRepeatedBytes-CopyPart-PersAutoDict-ChangeBinInt-CopyPart- DE: &#34;\000\000\000\000\000\000\000\003&#34;-
#103	REDUCE cov: 1659 ft: 2052 corp: 23/3541b lim: 4096 exec/s: 103 rss: 45Mb L: 92/371 MS: 5 CopyPart-ChangeByte-PersAutoDict-PersAutoDict-EraseBytes- DE: &#34;\000\000\000\000\000\000\000\003&#34;-&#34;\242\000\000\000&#34;-
#111	NEW    cov: 1659 ft: 2058 corp: 24/3824b lim: 4096 exec/s: 111 rss: 45Mb L: 283/371 MS: 3 CrossOver-ShuffleBytes-CrossOver-
#116	NEW    cov: 1665 ft: 2097 corp: 25/4184b lim: 4096 exec/s: 116 rss: 45Mb L: 360/371 MS: 5 InsertByte-InsertRepeatedBytes-CrossOver-CopyPart-InsertByte-
#121	NEW    cov: 1665 ft: 2098 corp: 26/4335b lim: 4096 exec/s: 121 rss: 45Mb L: 151/371 MS: 5 CrossOver-CrossOver-ChangeBit-ChangeBit-CopyPart-
#123	NEW    cov: 1665 ft: 2099 corp: 27/4462b lim: 4096 exec/s: 123 rss: 45Mb L: 127/371 MS: 2 ShuffleBytes-ChangeByte-
#124	NEW    cov: 1672 ft: 2123 corp: 28/4772b lim: 4096 exec/s: 124 rss: 45Mb L: 310/371 MS: 1 ShuffleBytes-
#129	NEW    cov: 1674 ft: 2127 corp: 29/4948b lim: 4096 exec/s: 129 rss: 45Mb L: 176/371 MS: 5 ChangeBit-PersAutoDict-ShuffleBytes-ChangeBit-ChangeBit- DE: &#34;\377\377\003\000&#34;-
#131	NEW    cov: 1674 ft: 2132 corp: 30/5215b lim: 4096 exec/s: 131 rss: 45Mb L: 267/371 MS: 2 PersAutoDict-PersAutoDict- DE: &#34;\000\000\000\000\000\000\000\003&#34;-&#34;\000\000\000\000\000\000\000\003&#34;-
#132	NEW    cov: 1675 ft: 2159 corp: 31/5366b lim: 4096 exec/s: 132 rss: 45Mb L: 151/371 MS: 1 ChangeBinInt-
#136	NEW    cov: 1675 ft: 2162 corp: 32/5914b lim: 4096 exec/s: 136 rss: 45Mb L: 548/548 MS: 4 CrossOver-CMP-ChangeBit-ChangeBinInt- DE: &#34;\023\002\000\000\000\000\000\000&#34;-
#147	NEW    cov: 1675 ft: 2170 corp: 33/5931b lim: 4096 exec/s: 147 rss: 46Mb L: 17/548 MS: 1 CMP- DE: &#34;\000\000\000\000&#34;-
#148	NEW    cov: 1676 ft: 2171 corp: 34/6081b lim: 4096 exec/s: 148 rss: 46Mb L: 150/548 MS: 1 InsertByte-
#150	NEW    cov: 1676 ft: 2172 corp: 35/6391b lim: 4096 exec/s: 150 rss: 46Mb L: 310/548 MS: 2 ChangeBit-ChangeByte-
#173	REDUCE cov: 1676 ft: 2172 corp: 35/6248b lim: 4096 exec/s: 173 rss: 46Mb L: 405/405 MS: 3 PersAutoDict-ShuffleBytes-EraseBytes- DE: &#34;\377\377\003\000&#34;-
#183	NEW    cov: 1676 ft: 2194 corp: 36/6616b lim: 4096 exec/s: 183 rss: 46Mb L: 368/405 MS: 5 PersAutoDict-ShuffleBytes-ChangeASCIIInt-ChangeBit-CMP- DE: &#34;\023\002\000\000\000\000\000\000&#34;-&#34;\264\000\000\000\000\000\000\000&#34;-
#192	REDUCE cov: 1676 ft: 2194 corp: 36/6583b lim: 4096 exec/s: 192 rss: 46Mb L: 77/405 MS: 4 CopyPart-ShuffleBytes-ChangeByte-EraseBytes-
#205	REDUCE cov: 1676 ft: 2196 corp: 37/6711b lim: 4096 exec/s: 205 rss: 47Mb L: 128/405 MS: 3 ChangeByte-ShuffleBytes-ChangeByte-
#209	NEW    cov: 1677 ft: 2207 corp: 38/6975b lim: 4096 exec/s: 209 rss: 47Mb L: 264/405 MS: 4 InsertRepeatedBytes-ChangeBinInt-ChangeBit-ChangeBinInt-
#215	NEW    cov: 1677 ft: 2231 corp: 39/7142b lim: 4096 exec/s: 215 rss: 47Mb L: 167/405 MS: 1 CrossOver-
#216	REDUCE cov: 1677 ft: 2231 corp: 39/7085b lim: 4096 exec/s: 216 rss: 47Mb L: 110/405 MS: 1 EraseBytes-
#262	NEW    cov: 1677 ft: 2232 corp: 40/7304b lim: 4096 exec/s: 262 rss: 48Mb L: 219/405 MS: 1 CopyPart-
#276	NEW    cov: 1677 ft: 2234 corp: 41/7656b lim: 4096 exec/s: 276 rss: 48Mb L: 352/405 MS: 4 PersAutoDict-InsertByte-ChangeBit-CrossOver- DE: &#34;\000\000\000\000\000\000\000\003&#34;-
#295	NEW    cov: 1677 ft: 2241 corp: 42/8193b lim: 4096 exec/s: 295 rss: 48Mb L: 537/537 MS: 4 ChangeByte-InsertRepeatedBytes-InsertByte-Inse
...truncated...
REDUCE cov: 2250 ft: 4940 corp: 222/135Kb lim: 4096 exec/s: 1341 rss: 67Mb L: 1206/3993 MS: 1 EraseBytes-
#8059	REDUCE cov: 2250 ft: 4940 corp: 222/135Kb lim: 4096 exec/s: 1343 rss: 67Mb L: 273/3993 MS: 2 ChangeBit-EraseBytes-
#8192	pulse  cov: 2250 ft: 4940 corp: 222/135Kb lim: 4096 exec/s: 1365 rss: 67Mb
#8295	REDUCE cov: 2250 ft: 4940 corp: 222/135Kb lim: 4096 exec/s: 1382 rss: 67Mb L: 1310/3993 MS: 1 EraseBytes-
#8388	REDUCE cov: 2250 ft: 4940 corp: 222/135Kb lim: 4096 exec/s: 1398 rss: 67Mb L: 167/3993 MS: 3 ShuffleBytes-CopyPart-EraseBytes-
#8402	REDUCE cov: 2250 ft: 4940 corp: 222/135Kb lim: 4096 exec/s: 1400 rss: 67Mb L: 2745/3993 MS: 4 ChangeByte-InsertRepeatedBytes-InsertByte-EraseBytes-
#8404	REDUCE cov: 2250 ft: 4940 corp: 222/135Kb lim: 4096 exec/s: 1400 rss: 67Mb L: 310/3993 MS: 2 PersAutoDict-EraseBytes- DE: &#34;en_US&#34;-
#8422	REDUCE cov: 2250 ft: 4940 corp: 222/134Kb lim: 4096 exec/s: 1403 rss: 67Mb L: 668/3993 MS: 3 PersAutoDict-ChangeBit-EraseBytes- DE: &#34;\026\000\000\000\000\000\000\000&#34;-
#8426	REDUCE cov: 2250 ft: 4940 corp: 222/134Kb lim: 4096 exec/s: 1404 rss: 67Mb L: 860/3993 MS: 4 InsertRepeatedBytes-InsertRepeatedBytes-ChangeByte-EraseBytes-
#8472	REDUCE cov: 2250 ft: 4940 corp: 222/134Kb lim: 4096 exec/s: 1412 rss: 67Mb L: 292/3993 MS: 1 EraseBytes-
#8506	REDUCE cov: 2250 ft: 4940 corp: 222/134Kb lim: 4096 exec/s: 1417 rss: 68Mb L: 549/3993 MS: 4 CMP-ChangeBinInt-InsertRepeatedBytes-EraseBytes- DE: &#34;\377\377\377\377\377\377\377\247&#34;-
#8507	REDUCE cov: 2250 ft: 4940 corp: 222/134Kb lim: 4096 exec/s: 1417 rss: 68Mb L: 389/3993 MS: 1 EraseBytes-
#8511	REDUCE cov: 2250 ft: 4940 corp: 222/134Kb lim: 4096 exec/s: 1418 rss: 68Mb L: 1142/3993 MS: 4 ChangeBit-PersAutoDict-InsertByte-EraseBytes- DE: &#34;\375\377\377\377\377\377\377\377&#34;-
#8520	NEW    cov: 2250 ft: 4941 corp: 223/137Kb lim: 4096 exec/s: 1420 rss: 68Mb L: 3972/3993 MS: 4 CMP-InsertByte-ChangeBit-CopyPart- DE: &#34;\377\377\377r&#34;-
	NEW_FUNC[1/1]: 0x55bc4f56fb00 in icu_76::NFRuleSet::setNonNumericalRule(icu_76::NFRule*) /src/icu/icu4c/source/i18n/nfrs.cpp:269

=================================================================
[1m[31m==12==ERROR: LeakSanitizer: detected memory leaks
[1m[0m
[1m[34mDirect leak of 112 byte(s) in 1 object(s) allocated from:
[1m[0m    #0 0x55bc4f43ed9e in malloc /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:69:3
    #1 0x55bc4f937de1 in icu_76::UMemory::operator new(unsigned long) /src/icu/icu4c/source/common/uobject.cpp:62:12
    #2 0x55bc4f576b34 in icu_76::NFRule::makeRules(icu_76::UnicodeString&amp;, icu_76::NFRuleSet*, icu_76::NFRule const*, icu_76::RuleBasedNumberFormat const*, icu_76::NFRuleList&amp;, UErrorCode&amp;) /src/icu/icu4c/source/i18n/nfrule.cpp:119:21
    #3 0x55bc4f56f2e3 in icu_76::NFRuleSet::parseRules(icu_76::UnicodeString&amp;, UErrorCode&amp;) /src/icu/icu4c/source/i18n/nfrs.cpp:222:9
    #4 0x55bc4f488127 in icu_76::RuleBasedNumberFormat::init(icu_76::UnicodeString const&amp;, icu_76::LocalizationInfo*, UParseError&amp;, UErrorCode&amp;) /src/icu/icu4c/source/i18n/rbnf.cpp:1624:27
    #5 0x55bc4f48970a in icu_76::RuleBasedNumberFormat::RuleBasedNumberFormat(icu_76::UnicodeString const&amp;, UParseError&amp;, UErrorCode&amp;) /src/icu/icu4c/source/i18n/rbnf.cpp:781:5
    #6 0x55bc4f47e239 in LLVMFuzzerTestOneInput /src/icu/icu4c/source/test/fuzzer/relative_date_time_formatter_fuzzer.cpp:27:32
    #7 0x55bc4f330800 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:614:13
    #8 0x55bc4f330025 in fuzzer::Fuzzer::RunOne(unsigned char const*, unsigned long, bool, fuzzer::InputInfo*, bool, bool*) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:516:7
    #9 0x55bc4f3317f5 in fuzzer::Fuzzer::MutateAndTestOne() /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:760:19
    #10 0x55bc4f3325e5 in fuzzer::Fuzzer::Loop(std::__Fuzzer::vector&lt;fuzzer::SizedFile, std::__Fuzzer::allocator&lt;fuzzer::SizedFile&gt;&gt;&amp;) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:905:5
    #11 0x55bc4f3208f6 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:914:6
    #12 0x55bc4f34ce22 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #13 0x7fcd4dc9e082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 0702430aef5fa3dda43986563e9ffcc47efbd75e)

DEDUP_TOKEN: __interceptor_malloc--icu_76::UMemory::operator new(unsigned long)--icu_76::NFRule::makeRules(icu_76::UnicodeString&amp;, icu_76::NFRuleSet*, icu_76::NFRule const*, icu_76::RuleBasedNumberFormat const*, icu_76::NFRuleList&amp;, UErrorCode&amp;)
[1m[34mIndirect leak of 528 byte(s) in 1 object(s) allocated from:
[1m[0m    #0 0x55bc4f43ed9e in malloc /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:69:3
    #1 0x55bc4f922eee in allocate /src/icu/icu4c/source/common/unistr.cpp:382:34
    #2 0x55bc4f922eee in icu_76::UnicodeString::cloneArrayIfNeeded(int, int, signed char, int**, signed char) /src/icu/icu4c/source/common/unistr.cpp:1909:8
    #3 0x55bc4f9303e5 in icu_76::UnicodeString::doReplace(int, int, char16_t const*, int, int) /src/icu/icu4c/source/common/unistr.cpp:1541:7
    #4 0x55bc4f574b36 in removeBetween /src/icu/icu4c/source/common/unicode/unistr.h:4746:10
    #5 0x55bc4f574b36 in icu_76::NFRule::parseRuleDescriptor(icu_76::UnicodeString&amp;, UErrorCode&amp;) /src/icu/icu4c/source/i18n/nfrule.cpp:267:21
    #6 0x55bc4f576c79 in NFRule /src/icu/icu4c/source/i18n/nfrule.cpp:49:9
    #7 0x55bc4f576c79 in icu_76::NFRule::makeRules(icu_76::UnicodeString&amp;, icu_76::NFRuleSet*, icu_76::NFRule const*, icu_76::RuleBasedNumberFormat const*, icu_76::NFRuleList&amp;, UErrorCode&amp;) /src/icu/icu4c/source/i18n/nfrule.cpp:119:25
    #8 0x55bc4f56f2e3 in icu_76::NFRuleSet::parseRules(icu_76::UnicodeString&amp;, UErrorCode&amp;) /src/icu/icu4c/source/i18n/nfrs.cpp:222:9
    #9 0x55bc4f488127 in icu_76::RuleBasedNumberFormat::init(icu_76::UnicodeString const&amp;, icu_76::LocalizationInfo*, UParseError&amp;, UErrorCode&amp;) /src/icu/icu4c/source/i18n/rbnf.cpp:1624:27
    #10 0x55bc4f48970a in icu_76::RuleBasedNumberFormat::RuleBasedNumberFormat(icu_76::UnicodeString const&amp;, UParseError&amp;, UErrorCode&amp;) /src/icu/icu4c/source/i18n/rbnf.cpp:781:5
    #11 0x55bc4f47e239 in LLVMFuzzerTestOneInput /src/icu/icu4c/source/test/fuzzer/relative_date_time_formatter_fuzzer.cpp:27:32
    #12 0x55bc4f330800 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:614:13
    #13 0x55bc4f330025 in fuzzer::Fuzzer::RunOne(unsigned char const*, unsigned long, bool, fuzzer::InputInfo*, bool, bool*) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:516:7
    #14 0x55bc4f3317f5 in fuzzer::Fuzzer::MutateAndTestOne() /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:760:19
    #15 0x55bc4f3325e5 in fuzzer::Fuzzer::Loop(std::__Fuzzer::vector&lt;fuzzer::SizedFile, std::__Fuzzer::allocator&lt;fuzzer::SizedFile&gt;&gt;&amp;) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:905:5
    #16 0x55bc4f3208f6 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:914:6
    #17 0x55bc4f34ce22 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #18 0x7fcd4dc9e082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 0702430aef5fa3dda43986563e9ffcc47efbd75e)

DEDUP_TOKEN: __interceptor_malloc--allocate--icu_76::UnicodeString::cloneArrayIfNeeded(int, int, signed char, int**, signed char)
SUMMARY: AddressSanitizer: 640 byte(s) leaked in 2 allocation(s).
INFO: to ignore leaks on libFuzzer side use -detect_leaks=0.

MS: 2 PersAutoDict-InsertRepeatedBytes- DE: &#34;\004\000\000\000\000\000\000\000&#34;-; base unit: 36877d0370478a6f8d6ed76315c290c7848e0599
artifact_prefix=&#39;./&#39;; Test unit written to ./leak-2f01d7ecc350898ff9b0add7b737c79e1b3526ba
stat::number_of_executed_units: 8523
stat::average_exec_per_sec:     1420
stat::new_units_added:          452
stat::slowest_unit_time_sec:    0
stat::peak_rss_mb:              68

</pre>

</body>